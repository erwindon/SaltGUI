!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){
/*@cc_on @*/
if(sorttable={init:function(){arguments.callee.done||(arguments.callee.done=!0,n&&clearInterval(n),document.createElement&&document.getElementsByTagName&&(sorttable.DATE_RE=/^(\d\d?)[\/\.-](\d\d?)[\/\.-]((\d\d)?\d\d)$/,a(document.getElementsByTagName("table"),function(e){-1!=e.className.search(/\bsortable\b/)&&sorttable.makeSortable(e)})))},makeSortable:function(e){if(0==e.getElementsByTagName("thead").length&&(the=document.createElement("thead"),the.appendChild(e.rows[0]),e.insertBefore(the,e.firstChild)),null==e.tHead&&(e.tHead=e.getElementsByTagName("thead")[0]),1==e.tHead.rows.length){sortbottomrows=[];for(var t=0;t<e.rows.length;t++)-1!=e.rows[t].className.search(/\bsortbottom\b/)&&(sortbottomrows[sortbottomrows.length]=e.rows[t]);if(sortbottomrows){null==e.tFoot&&(tfo=document.createElement("tfoot"),e.appendChild(tfo));for(t=0;t<sortbottomrows.length;t++)tfo.appendChild(sortbottomrows[t]);delete sortbottomrows}headrow=e.tHead.rows[0].cells;for(t=0;t<headrow.length;t++)headrow[t].className.match(/\bsorttable_nosort\b/)||(mtch=headrow[t].className.match(/\bsorttable_([a-z0-9]+)\b/),mtch&&(override=mtch[1]),mtch&&"function"==typeof sorttable["sort_"+override]?headrow[t].sorttable_sortfunction=sorttable["sort_"+override]:headrow[t].sorttable_sortfunction=sorttable.guessType(e,t),headrow[t].sorttable_columnindex=t,headrow[t].sorttable_tbody=e.tBodies[0],r(headrow[t],"click",sorttable.innerSortFunction=function(e){if(-1!=this.className.search(/\bsorttable_sorted\b/))return sorttable.reverse(this.sorttable_tbody),this.className=this.className.replace("sorttable_sorted","sorttable_sorted_reverse"),this.removeChild(document.getElementById("sorttable_sortfwdind")),sortrevind=document.createElement("span"),sortrevind.id="sorttable_sortrevind",sortrevind.innerHTML="&nbsp;↑",void this.appendChild(sortrevind);if(-1!=this.className.search(/\bsorttable_sorted_reverse\b/))return sorttable.reverse(this.sorttable_tbody),this.className=this.className.replace("sorttable_sorted_reverse","sorttable_sorted"),this.removeChild(document.getElementById("sorttable_sortrevind")),sortfwdind=document.createElement("span"),sortfwdind.id="sorttable_sortfwdind",sortfwdind.innerHTML="&nbsp;↓",void this.appendChild(sortfwdind);theadrow=this.parentNode,a(theadrow.childNodes,function(e){1==e.nodeType&&(e.className=e.className.replace("sorttable_sorted_reverse",""),e.className=e.className.replace("sorttable_sorted",""))}),sortfwdind=document.getElementById("sorttable_sortfwdind"),sortfwdind&&sortfwdind.parentNode.removeChild(sortfwdind),sortrevind=document.getElementById("sorttable_sortrevind"),sortrevind&&sortrevind.parentNode.removeChild(sortrevind),this.className+=" sorttable_sorted",sortfwdind=document.createElement("span"),sortfwdind.id="sorttable_sortfwdind",sortfwdind.innerHTML="&nbsp;↓",this.appendChild(sortfwdind),row_array=[],col=this.sorttable_columnindex,rows=this.sorttable_tbody.rows;for(var t=0;t<rows.length;t++)row_array[row_array.length]=[sorttable.getInnerText(rows[t].cells[col]),rows[t]];row_array.sort(this.sorttable_sortfunction),tb=this.sorttable_tbody;for(t=0;t<row_array.length;t++)tb.appendChild(row_array[t][1]);delete row_array}))}},guessType:function(e,t){sortfn=sorttable.sort_alpha;for(var n=0;n<e.tBodies[0].rows.length;n++)if(text=sorttable.getInnerText(e.tBodies[0].rows[n].cells[t]),""!=text){if(text.match(/^-?[�$�]?[\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1]),second=parseInt(possdate[2]),first>12)return sorttable.sort_ddmm;if(second>12)return sorttable.sort_mmdd;sortfn=sorttable.sort_ddmm}}return sortfn},getInnerText:function(e){if(!e)return"";if(hasInputs="function"==typeof e.getElementsByTagName&&e.getElementsByTagName("input").length,null!=e.getAttribute("sorttable_customkey"))return e.getAttribute("sorttable_customkey");if(void 0!==e.textContent&&!hasInputs)return e.textContent.replace(/^\s+|\s+$/g,"");if(void 0!==e.innerText&&!hasInputs)return e.innerText.replace(/^\s+|\s+$/g,"");if(void 0!==e.text&&!hasInputs)return e.text.replace(/^\s+|\s+$/g,"");switch(e.nodeType){case 3:if("input"==e.nodeName.toLowerCase())return e.value.replace(/^\s+|\s+$/g,"");case 4:return e.nodeValue.replace(/^\s+|\s+$/g,"");case 1:case 11:for(var t="",n=0;n<e.childNodes.length;n++)t+=sorttable.getInnerText(e.childNodes[n]);return t.replace(/^\s+|\s+$/g,"");default:return""}},reverse:function(e){newrows=[];for(var t=0;t<e.rows.length;t++)newrows[newrows.length]=e.rows[t];for(t=newrows.length-1;t>=0;t--)e.appendChild(newrows[t]);delete newrows},sort_numeric:function(e,t){return aa=parseFloat(e[0].replace(/[^0-9.-]/g,"")),isNaN(aa)&&(aa=0),bb=parseFloat(t[0].replace(/[^0-9.-]/g,"")),isNaN(bb)&&(bb=0),aa-bb},sort_alpha:function(e,t){return e[0]==t[0]?0:e[0]<t[0]?-1:1},sort_ddmm:function(e,t){return mtch=e[0].match(sorttable.DATE_RE),y=mtch[3],m=mtch[2],d=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt1=y+m+d,mtch=t[0].match(sorttable.DATE_RE),y=mtch[3],m=mtch[2],d=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt2=y+m+d,dt1==dt2?0:dt1<dt2?-1:1},sort_mmdd:function(e,t){return mtch=e[0].match(sorttable.DATE_RE),y=mtch[3],d=mtch[2],m=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt1=y+m+d,mtch=t[0].match(sorttable.DATE_RE),y=mtch[3],d=mtch[2],m=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt2=y+m+d,dt1==dt2?0:dt1<dt2?-1:1},shaker_sort:function(e,t){for(var n=0,r=e.length-1,o=!0;o;){o=!1;for(var i=n;i<r;++i)if(t(e[i],e[i+1])>0){var a=e[i];e[i]=e[i+1],e[i+1]=a,o=!0}if(r--,!o)break;for(i=r;i>n;--i)if(t(e[i],e[i-1])<0){a=e[i];e[i]=e[i-1],e[i-1]=a,o=!0}n++}}},document.addEventListener&&document.addEventListener("DOMContentLoaded",sorttable.init,!1),/WebKit/i.test(navigator.userAgent))var n=setInterval(function(){/loaded|complete/.test(document.readyState)&&sorttable.init()},10);function r(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=r.guid++),e.events||(e.events={});var i=e.events[t];i||(i=e.events[t]={},e["on"+t]&&(i[0]=e["on"+t])),i[n.$$guid]=n,e["on"+t]=o}}function o(e){var t=!0;e=e||i(((this.ownerDocument||this.document||this).parentWindow||window).event);var n=this.events[e.type];for(var r in n)this.$$handleEvent=n[r],!1===this.$$handleEvent(e)&&(t=!1);return t}function i(e){return e.preventDefault=i.preventDefault,e.stopPropagation=i.stopPropagation,e}window.onload=sorttable.init,r.guid=1,i.preventDefault=function(){this.returnValue=!1},i.stopPropagation=function(){this.cancelBubble=!0},Array.forEach||(Array.forEach=function(e,t,n){for(var r=0;r<e.length;r++)t.call(n,e[r],r,e)}),Function.prototype.forEach=function(e,t,n){for(var r in e)void 0===this.prototype[r]&&t.call(n,e[r],r,e)},String.forEach=function(e,t,n){Array.forEach(e.split(""),function(r,o){t.call(n,r,o,e)})};var a=function(e,t,n){if(e){var r=Object;if(e instanceof Function)r=Function;else{if(e.forEach instanceof Function)return void e.forEach(t,n);"string"==typeof e?r=String:"number"==typeof e.length&&(r=Array)}r.forEach(e,t,n)}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.path=new RegExp(t),this.name=n,this.page_element=document.querySelector(r),this.router=i,o&&(this.menuitem_element1=document.querySelector(o+"1"),this.menuitem_element2=document.querySelector(o+"2"))}var t,n,i;return t=e,i=[{key:"_createTd",value:function(e,t){var n=document.createElement("td");return e&&(n.className=e),n.innerText=t,n}},{key:"_createDiv",value:function(e,t){var n=document.createElement("div");return e&&(n.className=e),n.innerText=t,n}}],(n=[{key:"getName",value:function(){return this.name}},{key:"getPath",value:function(){return this.path}},{key:"getPageElement",value:function(){return this.page_element}},{key:"getMenuItemElement1",value:function(){return this.menuitem_element1}},{key:"getMenuItemElement2",value:function(){return this.menuitem_element2}},{key:"_runCommand",value:function(e,t,n){this._runFullCommand(e,"",t,n)}},{key:"_runFullCommand",value:function(e,t,n,r){this.router.commandbox._showManualRun(e);var o=document.querySelector("#target"),i=document.querySelector("#command"),a=document.querySelector("#targetbox");if("unknown-target"===n&&(n="",t=""),r.startsWith("wheel.")&&n.endsWith("_master")&&(n="",t=""),r.startsWith("runners.")&&(n="",t=""),n||(n=""),r||(r=""),t){var u=t;a.style.display="inherit","glob"!==u&&"list"!==u&&"compound"!==u&&"nodegroup"!==u&&(u="glob"),TargetType.setTargetType(u)}o.value=n,i.value=r,this.router.commandbox.cmdmenu.verifyAll()}},{key:"_decodeArgumentsText",value:function(e){var t=e,n="";switch(r(t)){case"undefined":n="";break;case"object":var o=Object.keys(t).sort(),i=!0,a=!1,u=void 0;try{for(var l,s=o[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=l.value;c.includes("__")||(n=n+c+"="+t[c])}}catch(e){a=!0,u=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw u}}break;default:n=JSON.stringify(t)}return n}}])&&o(t.prototype,n),i&&o(t,i),e}();function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(e,n,r,o,i){var u,c,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c=this,(u=!(d=l(t).call(this,e,n,r,o,i))||"object"!==a(d)&&"function"!=typeof d?s(c):d)._runCommand=u._runCommand.bind(s(u)),u._runningJobs=u._runningJobs.bind(s(u)),u._updateJobs=u._updateJobs.bind(s(u)),u._updateMinions=u._updateMinions.bind(s(u)),u}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,i),n=t,(r=[{key:"_updateMinions",value:function(e){var t=e.return[0],n=this.getPageElement().querySelector("#minions"),r=Object.keys(t).sort();window.localStorage.setItem("minions",JSON.stringify(r));var o=!0,i=!1,a=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var s=u.value,c=t[s];!1===c?this._updateOfflineMinion(n,s):this._updateMinion(n,c,s)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}},{key:"_getElement",value:function(e,t){var n=document.getElementById(t);if(null===n)return(n=document.createElement("tr")).id=t,e.appendChild(n),n;for(;n.firstChild;)n.removeChild(n.firstChild);return n}},{key:"_updateOfflineMinion",value:function(e,t){var n=this._getElement(e,t);n.appendChild(i._createTd("hostname",t));var r=i._createTd("status","offline");r.classList.add("offline"),n.appendChild(r)}},{key:"_getBestIpNumber",value:function(e){if(!e)return null;var t=e.fqdn_ip4;if(!t)return null;if(!Array.isArray(t))return t;var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;if(!u.startsWith("127.")&&(!u.startsWith("10.")&&!u.startsWith("172.16.")&&!(u.startsWith("172.17.")||u.startsWith("172.18.")||u.startsWith("172.19.")||u.startsWith("172.20.")||u.startsWith("172.21.")||u.startsWith("172.22.")||u.startsWith("172.23.")||u.startsWith("172.24.")||u.startsWith("172.25.")||u.startsWith("172.26.")||u.startsWith("172.27.")||u.startsWith("172.28.")||u.startsWith("172.29.")||u.startsWith("172.30.")||u.startsWith("172.31.")||u.startsWith("192.168."))))return u}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var l=!0,s=!1,c=void 0;try{for(var d,p=t[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=d.value;if(!f.startsWith("127."))return f}}catch(e){s=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(s)throw c}}return t[0]}},{key:"_updateMinion",value:function(e,t,n){var r=this._getElement(e,n);r.appendChild(i._createTd("hostname",n));var o=this._getBestIpNumber(t);if(o){var a=i._createTd("status",o),u=o.split("."),l="";if(4===u.length){for(var s=0;s<4;s++)l+=u[s].padStart(3,"0");a.setAttribute("sorttable_customkey",l)}a.classList.add("address"),a.setAttribute("tabindex",-1),a.addEventListener("click",this._copyAddress),r.appendChild(a)}else{var c=i._createTd("status","accepted");c.classList.add("accepted"),r.appendChild(c)}var d="---";t&&t.saltversion&&(d=t.saltversion),t&&r.appendChild(i._createTd("saltversion",d));var p="---";if(t&&t.os&&t.osrelease?p=t.os+" "+t.osrelease:t&&t.os&&(p=t.os),t){var f=i._createTd("os",p);if(t.os){var y=document.createElement("img");y.setAttribute("src","static/images/os-"+t.os.replace(" ","-").toLowerCase()+".png"),y.classList.add("osimage"),f.prepend(y)}r.appendChild(f)}}},{key:"_addMinion",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=document.getElementById(t);if(null===r){(r=document.createElement("tr")).id=t,r.appendChild(i._createTd("hostname",t));var o=i._createTd("status","accepted");for(o.classList.add("accepted"),r.appendChild(o),r.appendChild(i._createTd("os","loading..."));r.cells.length<e.tHead.rows[0].cells.length-n;)r.appendChild(i._createTd("",""));e.tBodies[0].appendChild(r)}}},{key:"_addNone",value:function(e){var t=document.createElement("tr"),n=i._createTd("hostname","none");n.setAttribute("colspan",e.rows[0].cells.length),t.appendChild(n),e.appendChild(t)}},{key:"_updateJobs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPageElement().querySelector(".jobs tbody"),o=this._jobsToArray(e.return[0]);this._sortJobs(o);for(var i=0,a=0;i<t&&void 0!==o[a];){var u=o[a];a+=1,"grains.append"!==u.Function&&("grains.delkey"!==u.Function&&"grains.delval"!==u.Function&&"grains.items"!==u.Function&&"grains.setval"!==u.Function&&"pillar.items"!==u.Function&&"pillar.obfuscate"!==u.Function&&"runner.jobs.active"!==u.Function&&"runner.jobs.list_job"!==u.Function&&"runner.jobs.list_jobs"!==u.Function&&"saltutil.find_job"!==u.Function&&"saltutil.refresh_grains"!==u.Function&&"saltutil.refresh_pillar"!==u.Function&&"saltutil.running"!==u.Function&&"schedule.delete"!==u.Function&&"schedule.disable"!==u.Function&&"schedule.disable_job"!==u.Function&&"schedule.enable"!==u.Function&&"schedule.enable_job"!==u.Function&&"schedule.list"!==u.Function&&"schedule.modify"!==u.Function&&"schedule.run_job"!==u.Function&&"sys.doc"!==u.Function&&"wheel.config.values"!==u.Function&&"wheel.key.accept"!==u.Function&&"wheel.key.delete"!==u.Function&&"wheel.key.list_all"!==u.Function&&"wheel.key.reject"!==u.Function&&"wheel.key.finger"!==u.Function&&(!0===n?this._addDetailedJob(r,u):this._addJob(r,u),i+=1))}this.jobsLoaded=!0,this.keysLoaded&&this.jobsLoaded&&this.resolvePromise()}},{key:"_runningJobs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.return[0];for(var r in n){var o=n[r],i="",a=void 0;!0===t?a=document.querySelector(".jobs #job"+r+" .status"):(i=window.makeTargetText(o["Target-type"],o.Target)+", ",a=document.querySelector(".jobs #job"+r+" .target")),o.Running.length>0&&(i=i+o.Running.length+" running"),o.Returned.length>0&&(i=i+", "+o.Returned.length+" returned"),a&&(a.classList.remove("no_status"),a.innerText=i)}var u=!0,l=!1,s=void 0;try{for(var c,d=document.querySelector("table#jobs tbody").rows[Symbol.iterator]();!(u=(c=d.next()).done);u=!0){var p=c.value.querySelector(".no_status");p&&(p.classList.remove("no_status"),p.innerText="done")}}catch(e){l=!0,s=e}finally{try{u||null==d.return||d.return()}finally{if(l)throw s}}}},{key:"_addJob",value:function(e,t){var n=document.createElement("tr"),r=document.createElement("td");r.id="job"+t.id;var o=window.makeTargetText(t["Target-type"],t.Target);r.appendChild(i._createDiv("target",o));var a=t.Function;r.appendChild(i._createDiv("function",a));var u=Output.dateTimeStr(t.StartTime);r.appendChild(i._createDiv("time",u)),n.appendChild(r),new DropDownMenu(n).addMenuItem("Show&nbsp;details",function(e){window.location.assign("/job?id="+encodeURIComponent(t.id))}.bind(this)),e.appendChild(n),n.addEventListener("click",this._createJobListener(t.id))}},{key:"_addDetailedJob",value:function(e,t){var n=document.createElement("tr");n.id="job"+t.id;var r=t.id;n.appendChild(i._createTd("job"+t.id,r));var o=window.makeTargetText(t["Target-type"],t.Target);o.length>50&&(o=o.substring(0,50)+"..."),n.appendChild(i._createTd("target",o));var a=this._decodeArgumentsText(t.Arguments[0]),u=t.Function+" "+a;n.appendChild(i._createTd("function",u));var l=t.StartTime;n.appendChild(i._createTd("starttime",l));var s=new DropDownMenu(n);s.addMenuItem("Show&nbsp;details",function(e){window.location.assign("/job?id="+encodeURIComponent(t.id))}.bind(this)),s.addMenuItem("Re-run&nbsp;job...",function(e){this._runFullCommand(e,t["Target-type"],t.Target,u)}.bind(this));var c=i._createTd("status","loading...");for(c.classList.add("no_status"),n.appendChild(c);n.cells.length<e.parentElement.tHead.rows[0].cells.length;)n.appendChild(i._createTd("",""));e.appendChild(n),n.addEventListener("click",function(e){return window.location.assign("/job?id="+encodeURIComponent(t.id))})}},{key:"_createJobListener",value:function(e){var t=this.router;return function(){t.goTo("/job?id="+encodeURIComponent(e))}}},{key:"_jobsToArray",value:function(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++){var o=t[r],i=e[o];i.id=o,n.push(i)}return n}},{key:"_sortJobs",value:function(e){e.sort(function(e,t){return e.id<t.id?1:e.id>t.id?-1:0})}},{key:"_copyAddress",value:function(e){var t=e.target,n=window.getSelection(),r=document.createRange();r.selectNodeContents(t),n.removeAllRanges(),n.addRange(r),document.execCommand("copy"),e.stopPropagation()}}])&&u(n.prototype,r),o&&u(n,o),t}();function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=y(t).call(this,"^[/]grainsminion$","Grains","#page_grainsminion","#button_grains",e),(n=!o||"object"!==p(o)&&"function"!=typeof o?m(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._showGrains=n._showGrains.bind(m(n)),document.querySelector("#button_close_grainsminion").addEventListener("click",function(e){n.router.goTo("/grains")}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this,t=decodeURIComponent(window.getQueryParam("minion"));return document.getElementById("grainsminion_title").innerText="Grains on "+t,new Promise(function(n,r){e.resolvePromise=n,e.keysLoaded&&e.jobsLoaded&&n(),e.router.api.getGrainsItems(t).then(e._showGrains),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_showGrains",value:function(e){var t=this,n=decodeURIComponent(window.getQueryParam("minion")),r=e.return[0][n],o=document.getElementById("grainsminion_page"),i=new DropDownMenu(o);i.addMenuItem("Add&nbsp;grain...",function(e){this._runCommand(e,n,'grains.setval "name" "value"')}.bind(this)),i.addMenuItem("Refresh&nbsp;grains...",function(e){this._runCommand(e,n,"saltutil.refresh_grains")}.bind(this));var a=document.getElementById("grainsminion_list");for(o.appendChild(a);a.tBodies[0].rows.length>0;)a.tBodies[0].deleteRow(0);if(r){var u=Object.keys(r).sort(),l=!0,s=!1,c=void 0;try{for(var d,p=function(){var e=d.value,o=document.createElement("tr"),i=Route._createTd("grain_name",e);o.appendChild(i);var u=Output.formatObject(r[e]),l=new DropDownMenu(o);l.addMenuItem("Edit&nbsp;grain...",function(t){this._runCommand(t,n,'grains.setval "'+e+'" '+JSON.stringify(r[e]))}.bind(t)),u.startsWith("[")&&l.addMenuItem("Add&nbsp;value...",function(t){this._runCommand(t,n,'grains.append "'+e+'" "value"')}.bind(t)),l.addMenuItem("Delete&nbsp;key...",function(t){this._runCommand(t,n,'grains.delkey "'+e+'"')}.bind(t)),l.addMenuItem("Delete&nbsp;value...",function(t){this._runCommand(t,n,'grains.delval "'+e+'"')}.bind(t));var s=Route._createTd("grain_value",u);o.appendChild(s),a.tBodies[0].appendChild(o),o.addEventListener("click",function(o){return t._runCommand(o,n,'grains.setval "'+e+'" '+JSON.stringify(r[e]))})},f=u[Symbol.iterator]();!(l=(d=f.next()).done);l=!0)p()}catch(e){s=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(s)throw c}}}}}])&&f(n.prototype,r),o&&f(n,o),t}();function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t,n){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(0);var k=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=T(t).call(this,"^[/]grains$","Grains","#page_grains","#button_grains",e))||"object"!==v(o)&&"function"!=typeof o?_(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._updateKeys=n._updateKeys.bind(_(n)),n._updateMinion=n._updateMinion.bind(_(n));var i=window.localStorage.getItem("preview_grains");i&&"undefined"!==i||(i="[]"),n._previewGrains=JSON.parse(i),Array.isArray(n._previewGrains)||(n._previewGrains=[]);for(var a=document.querySelector("#page_grains thead tr");a.childElementCount>6;)a.removeChild(a.lastChild);for(var u=0;u<n._previewGrains.length;u++){var l=document.createElement("th");l.innerText=n._previewGrains[u],a.appendChild(l)}return sorttable.makeSortable(document.querySelector("#page_grains table")),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this;return new Promise(function(t,n){e.resolvePromise=t,e.keysLoaded&&e.jobsLoaded&&t(),e.router.api.getMinions().then(e._updateMinions),e.router.api.getKeys().then(e._updateKeys),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_updateKeys",value:function(e){var t=this,n=e.return,r=this.getPageElement().querySelector("#minions"),o=n.minions.sort(),i=!0,a=!1,u=void 0;try{for(var l,s=function(){var e=l.value;t._addMinion(r,e,1+t._previewGrains.length);var n=document.getElementById(e),o=new DropDownMenu(n);t._addMenuItemShowGrains(o,e);for(var i=0;i<t._previewGrains.length;i++)n.appendChild(Route._createTd("",""));n.addEventListener("click",function(t){return window.location.assign("grainsminion?minion="+encodeURIComponent(e))})},c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)s()}catch(e){a=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw u}}this.keysLoaded=!0,this.keysLoaded&&this.jobsLoaded&&this.resolvePromise()}},{key:"_updateOfflineMinion",value:function(e,n){w(T(t.prototype),"_updateOfflineMinion",this).call(this,e,n);var r=document.getElementById(n);r.appendChild(Route._createTd("saltversion","")),r.appendChild(Route._createTd("os","")),r.appendChild(Route._createTd("graininfo","")),r.appendChild(Route._createTd("run-command-button",""));for(var o=0;o<this._previewGrains.length;o++)r.appendChild(Route._createTd("",""))}},{key:"_updateMinion",value:function(e,n,r){w(T(t.prototype),"_updateMinion",this).call(this,e,n,r);var o=document.getElementById(r),i=Object.keys(n).length,a=i+" grains",u=Route._createTd("graininfo",a);u.setAttribute("sorttable_customkey",i),o.appendChild(u);var l=new DropDownMenu(o);for(this._addMenuItemShowGrains(l,r);o.childElementCount>6;)o.removeChild(o.lastChild);for(var s=0;s<this._previewGrains.length;s++){var c=document.createElement("td"),d=this._previewGrains[s];d in n&&(c.innerText=Output.formatObject(n[d]),c.classList.add("grain_value")),o.appendChild(c)}o.addEventListener("click",function(e){return window.location.assign("grainsminion?minion="+encodeURIComponent(r))})}},{key:"_addMenuItemShowGrains",value:function(e,t){e.addMenuItem("Show&nbsp;grains",function(e){window.location.assign("grainsminion?minion="+encodeURIComponent(t))}.bind(this))}}])&&g(n.prototype,r),o&&g(n,o),t}();function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=E(t).call(this,"^[/]job$","Job","#page_job","",e))||"object"!==R(o)&&"function"!=typeof o?j(r):o)._onJobData=n._onJobData.bind(j(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,i),n=t,(r=[{key:"onShow",value:function(){var e=this,t=decodeURIComponent(window.getQueryParam("id"));return new Promise(function(n,r){e.resolvePromise=n,e.router.api.getJob(t).then(e._onJobData)})}},{key:"_isResultOk",value:function(e){return!!e.success&&0===e.retcode}},{key:"_onJobData",value:function(e){var t=this,n=e.info[0];this.getPageElement().querySelector(".output").innerText="",document.querySelector("#button_close_job").addEventListener("click",function(e){t.router.goTo("/jobs")});var r=this._decodeArgumentsText(n.Arguments[0]),o=n.Function+" "+r,i=document.getElementById("job_page"),a=i.querySelector(".job_menu"),u=new DropDownMenu(a);u.addMenuItem("Re-run&nbsp;job...",function(e){this._runFullCommand(e,n["Target-type"],n.Target,o)}.bind(this));var l="";if(n.Minions){var s=!0,c=!1,d=void 0;try{for(var p,f=n.Minions[Symbol.iterator]();!(s=(p=f.next()).done);s=!0){l+=","+p.value}}catch(e){c=!0,d=e}finally{try{s||null==f.return||f.return()}finally{if(c)throw d}}}if(l&&l===","+n.Minions[0]&&(l=null),l){var y=l.substring(1);u.addMenuItem("Re-run&nbsp;job&nbsp;on&nbsp;all&nbsp;minions...",function(e){this._runFullCommand(e,"list",y,o)}.bind(this))}l="";var m=!1,h=!1;if(n.Minions){var b=!0,v=!1,g=void 0;try{for(var _,w=n.Minions[Symbol.iterator]();!(b=(_=w.next()).done);b=!0){var T=_.value;T in n.Result||(m=!0),T in n.Result&&!this._isResultOk(n.Result[T])&&(h=!0),T in n.Result&&this._isResultOk(n.Result[T])||(l+=","+T)}}catch(e){v=!0,g=e}finally{try{b||null==w.return||w.return()}finally{if(v)throw g}}}if(m&&h&&l){var S=l.substring(1);u.addMenuItem("Re-run&nbsp;job&nbsp;on&nbsp;unsuccessful&nbsp;minions...",function(e){this._runFullCommand(e,"list",S,o)}.bind(this))}if(l="",n.Minions){var k=!0,R=!1,O=void 0;try{for(var E,j=n.Minions[Symbol.iterator]();!(k=(E=j.next()).done);k=!0){var C=E.value;C in n.Result&&!this._isResultOk(n.Result[C])&&(l+=","+C)}}catch(e){R=!0,O=e}finally{try{k||null==j.return||j.return()}finally{if(R)throw O}}}if(l){var P=l.substring(1);u.addMenuItem("Re-run&nbsp;job&nbsp;on&nbsp;failed&nbsp;minions...",function(e){this._runFullCommand(e,"list",P,o)}.bind(this))}if(l="",n.Minions){var M=!0,I=!1,L=void 0;try{for(var x,D=n.Minions[Symbol.iterator]();!(M=(x=D.next()).done);M=!0){var q=x.value;q in n.Result||(l+=","+q)}}catch(e){I=!0,L=e}finally{try{M||null==D.return||D.return()}finally{if(I)throw L}}}if(l){var J=l.substring(1);u.addMenuItem("Re-run&nbsp;job&nbsp;on&nbsp;non&nbsp;responding&nbsp;minions...",function(e){this._runFullCommand(e,"list",J,o)}.bind(this))}var N=o+" on "+window.makeTargetText(n["Target-type"],n.Target);i.querySelector(".function").innerText=N,i.querySelector(".time").innerText=Output.dateTimeStr(n.StartTime);var A=this.getPageElement().querySelector(".output"),B=["WHEEL"];n.Minions&&(B=n.Minions),Output.addResponseOutput(A,B,n.Result,n.Function),this.resolvePromise()}}])&&O(n.prototype,r),o&&O(n,o),t}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var q=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=L(this,x(t).call(this,"^[/]jobs$","Jobs","#page_jobs","#button_jobs",e))).jobsLoaded=!1,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this;return new Promise(function(t,n){e.resolvePromise=t,e.jobsLoaded&&t(),e.router.api.getJobs().then(function(t){e._updateJobs(t,50,!0)}),e.router.api.getJobsActive().then(function(t){e._runningJobs(t,!0)})})}}])&&I(n.prototype,r),o&&I(n,o),t}();function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t,n){return(B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var K=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=F(t).call(this,"^[/]keys$","Keys","#page_keys","#button_keys",e))||"object"!==J(o)&&"function"!=typeof o?A(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._updateKeys=n._updateKeys.bind(A(n)),n._updateKeysFingerprint=n._updateKeysFingerprint.bind(A(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this,t=e.router.api.getKeys(),n=e.router.api.getKeysFingerprint();return Promise.all([t,n]).then(function(t){e._updateKeys(t[0]),e._updateKeysFingerprint(t[1])}),new Promise(function(t,n){e.resolvePromise=t,e.keysLoaded&&e.jobsLoaded&&t(),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_updateKeysFingerprint",value:function(e){for(var t=e.return[0].data.return,n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];if("local"!==o)for(var i=t[o],a=Object.keys(i),u=0;u<a.length;u++){var l=a[u],s=document.querySelector("#"+l+" .os");s&&(s.parentElement.insertBefore(Route._createTd("fingerprint",""),s),s.parentElement.removeChild(s));var c=document.querySelector("#"+l+" .fingerprint"),d=i[l];c&&(c.innerText=d)}}}},{key:"_updateKeys",value:function(e){var t=e.return,n=this.getPageElement().querySelector("#minions"),r=t.minions_pre.sort(),o=!0,i=!1,a=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var s=u.value;this._addPreMinion(n,s)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}var c=t.minions.sort(),d=!0,p=!1,f=void 0;try{for(var y,m=c[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var h=y.value;this._addMinion(n,h,1);var b=document.getElementById(h),v=new DropDownMenu(b);this._addMenuItemReject(v,h," include_accepted=true"),this._addMenuItemDelete(v,h,"")}}catch(e){p=!0,f=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw f}}var g=t.minions_denied.sort(),_=!0,w=!1,T=void 0;try{for(var S,k=g[Symbol.iterator]();!(_=(S=k.next()).done);_=!0){var R=S.value;this._addDeniedMinion(n,R)}}catch(e){w=!0,T=e}finally{try{_||null==k.return||k.return()}finally{if(w)throw T}}var O=t.minions_rejected.sort(),E=!0,j=!1,C=void 0;try{for(var P,M=O[Symbol.iterator]();!(E=(P=M.next()).done);E=!0){var I=P.value;this._addRejectedMinion(n,I)}}catch(e){j=!0,C=e}finally{try{E||null==M.return||M.return()}finally{if(j)throw C}}var L="";if(0===r.length&&(L+=", no unaccepted keys"),0===c.length&&(L+=", no accepted keys"),0===g.length&&(L+=", no denied keys"),0===O.length&&(L+=", no rejected keys"),L){var x=Route._createDiv("msg",L.replace(/, n/,"N"));this.getPageElement().querySelector(".minion-list").appendChild(x)}this.keysLoaded=!0,this.keysLoaded&&this.jobsLoaded&&this.resolvePromise()}},{key:"_updateOfflineMinion",value:function(e,n){B(F(t.prototype),"_updateOfflineMinion",this).call(this,e,n);var r=document.getElementById(n);r.appendChild(Route._createTd("fingerprint",""));var o=new DropDownMenu(r);this._addMenuItemReject(o,n," include_accepted=true"),this._addMenuItemDelete(o,n,"")}},{key:"_addRejectedMinion",value:function(e,t){var n=this._getElement(e,t);n.appendChild(Route._createTd("hostname",t));var r=Route._createTd("status","rejected");r.classList.add("rejected"),n.appendChild(r),n.appendChild(Route._createTd("fingerprint",""));var o=new DropDownMenu(n);this._addMenuItemDelete(o,t,""),this._addMenuItemAccept(o,t," include_rejected=true"),e.tBodies[0].appendChild(n)}},{key:"_addDeniedMinion",value:function(e,t){var n=this._getElement(e,t);n.appendChild(Route._createTd("hostname",t));var r=Route._createTd("status","denied");r.classList.add("denied"),n.appendChild(r),n.appendChild(Route._createTd("fingerprint",""));var o=new DropDownMenu(n);this._addMenuItemAccept(o,t," include_denied=true"),this._addMenuItemReject(o,t," include_denied=true"),this._addMenuItemDelete(o,t,""),e.tBodies[0].appendChild(n)}},{key:"_addPreMinion",value:function(e,t){var n=this._getElement(e,t);n.appendChild(Route._createTd("hostname",t));var r=Route._createTd("status","unaccepted");r.classList.add("unaccepted"),n.appendChild(r),n.appendChild(Route._createTd("fingerprint",""));var o=new DropDownMenu(n);this._addMenuItemAccept(o,t,""),this._addMenuItemReject(o,t,""),this._addMenuItemDelete(o,t,""),e.tBodies[0].appendChild(n)}},{key:"_addMenuItemAccept",value:function(e,t,n){e.addMenuItem("Accept&nbsp;key...",function(e){this._runCommand(e,t,"wheel.key.accept"+n)}.bind(this))}},{key:"_addMenuItemReject",value:function(e,t,n){e.addMenuItem("Reject&nbsp;key...",function(e){this._runCommand(e,t,"wheel.key.reject"+n)}.bind(this))}},{key:"_addMenuItemDelete",value:function(e,t,n){e.addMenuItem("Delete&nbsp;key...",function(e){this._runCommand(e,t,"wheel.key.delete"+n)}.bind(this))}}])&&N(n.prototype,r),o&&N(n,o),t}();function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=G(t).call(this,"^[/]login$","Login","#page_login","",e))||"object"!==$(o)&&"function"!=typeof o?H(r):o).loginPending=!1,n.onLogin=n.onLogin.bind(H(n)),n.onLoginSuccess=n.onLoginSuccess.bind(H(n)),n.onLoginFailure=n.onLoginFailure.bind(H(n)),n.registerEventListeners(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(t,i),n=t,(r=[{key:"onShow",value:function(){var e=document.querySelector("#login-form #eauth"),t=window.localStorage.getItem("eauth");e.value=t||"pam"}},{key:"registerEventListeners",value:function(){document.querySelector("#login-form").addEventListener("submit",this.onLogin)}},{key:"onLogin",value:function(e){if(e.preventDefault(),!this.loginPending){var t=document.querySelector("#username").value,n=document.querySelector("#password").value,r=document.querySelector("#eauth").value;this.toggleForm(!1),this.router.api.login(t,n,r).then(this.onLoginSuccess,this.onLoginFailure)}}},{key:"onLoginSuccess",value:function(){this.toggleForm(!0);var e=document.querySelector(".notice-wrapper"),t=i._createDiv("notice","Please wait...");t.style.backgroundColor="#4CAF50",e.replaceChild(t,e.firstChild),document.querySelector("#username").disabled=!0,document.querySelector("#password").disabled=!0,document.querySelector("#eauth").disabled=!0,e.className="notice-wrapper",e.focus(),e.className="notice-wrapper show",this.router.goTo("/")}},{key:"onLoginFailure",value:function(){this.toggleForm(!0);var e=document.querySelector(".notice-wrapper"),t=i._createDiv("notice","Authentication failed");t.style.backgroundColor="#F44336",e.replaceChild(t,e.firstChild),e.className="notice-wrapper",e.focus(),e.className="notice-wrapper show"}},{key:"toggleForm",value:function(e){this.loginPending=!e,document.querySelector("#login-form input[type='submit']").disabled=!e}}])&&U(n.prototype,r),o&&U(n,o),t}();function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e,t,n){return(Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ee(t).call(this,"^[/]$","Minions","#page_minions","#button_minions",e))||"object"!==z(o)&&"function"!=typeof o?Y(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._updateKeys=n._updateKeys.bind(Y(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this;return new Promise(function(t,n){e.resolvePromise=t,e.keysLoaded&&e.jobsLoaded&&t(),e.router.api.getMinions().then(e._updateMinions),e.router.api.getKeys().then(e._updateKeys),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs),e.router.api.getConfigValues().then(e._configvalues)})}},{key:"_configvalues",value:function(e){var t=e.return[0].data.return.saltgui_templates;window.localStorage.setItem("templates",JSON.stringify(t));var n=e.return[0].data.return.saltgui_public_pillars;window.localStorage.setItem("public_pillars",JSON.stringify(n));var r=e.return[0].data.return.saltgui_preview_grains;window.localStorage.setItem("preview_grains",JSON.stringify(r));var o=e.return[0].data.return.nodegroups;o||(o={}),window.localStorage.setItem("nodegroups",JSON.stringify(o));var i=e.return[0].data.return.saltgui_output_formats;window.localStorage.setItem("output_formats",JSON.stringify(i));var a=e.return[0].data.return.saltgui_datetime_fraction_digits;window.localStorage.setItem("datetime_fraction_digits",JSON.stringify(a))}},{key:"_updateKeys",value:function(e){var t=this,n=e.return,r=this.getPageElement().querySelector("#minions"),o=n.minions.sort(),i=!0,a=!1,u=void 0;try{for(var l,s=function(){var e=l.value;t._addMinion(r,e,1);var n=document.getElementById(e),o=new DropDownMenu(n);t._addMenuItemStateApply(o,e),n.addEventListener("click",function(n){return t._runCommand(n,e,"state.apply")})},c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)s()}catch(e){a=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw u}}this.keysLoaded=!0,this.keysLoaded&&this.jobsLoaded&&this.resolvePromise()}},{key:"_updateOfflineMinion",value:function(e,n){Z(ee(t.prototype),"_updateOfflineMinion",this).call(this,e,n);var r=document.getElementById(n);r.appendChild(Route._createTd("saltversion","")),r.appendChild(Route._createTd("os","")),r.appendChild(Route._createTd("run-command-button",""))}},{key:"_updateMinion",value:function(e,n,r){var o=this;Z(ee(t.prototype),"_updateMinion",this).call(this,e,n,r);var i=document.getElementById(r),a=new DropDownMenu(i);this._addMenuItemStateApply(a,r),i.addEventListener("click",function(e){return o._runCommand(e,r,"state.apply")})}},{key:"_addMenuItemStateApply",value:function(e,t){e.addMenuItem("Apply&nbsp;state...",function(e){this._runCommand(e,t,"state.apply")}.bind(this))}}])&&X(n.prototype,r),o&&X(n,o),t}();function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var le=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=ie(t).call(this,"^[/]pillarsminion$","Pillars","#page_pillarsminion","#button_pillars",e),(n=!o||"object"!==re(o)&&"function"!=typeof o?ae(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._showPillars=n._showPillars.bind(ae(n)),document.querySelector("#button_close_pillarsminion").addEventListener("click",function(e){n.router.goTo("/pillars")}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this,t=decodeURIComponent(window.getQueryParam("minion"));return document.getElementById("pillarsminion_title").innerText="Pillars on "+t,new Promise(function(n,r){e.resolvePromise=n,e.keysLoaded&&e.jobsLoaded&&n(),e.router.api.getPillarItems(t).then(e._showPillars),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_showPillars",value:function(e){var t=decodeURIComponent(window.getQueryParam("minion")),n=e.return[0][t],r=document.getElementById("pillarsminion_page"),o=new DropDownMenu(r);this._addMenuItemRefreshPillar(o,t);var i=document.getElementById("pillarsminion_list");for(r.appendChild(i);i.tBodies[0].rows.length>0;)i.tBodies[0].deleteRow(0);if(n){var a=window.localStorage.getItem("public_pillars");a&&"undefined"!==a||(a="[]");var u=JSON.parse(a);Array.isArray(u)||(u=[]);for(var l=0;l<u.length;l++)try{u[l]=new RegExp(u[l])}catch(e){u[l]=null}var s=Object.keys(n).sort(),c=!0,d=!1,p=void 0;try{for(var f,y=function(){var e=f.value,t=document.createElement("tr"),r=Route._createTd("pillar_name",e);t.appendChild(r);var o=Route._createTd("pillar_hidden","●●●●●●●●");t.appendChild(o);var a=Output.formatObject(n[e]),l=Route._createTd("pillar_shown",a);l.style.display="none",t.appendChild(l);for(var s=0;s<u.length;s++)if(u[s]&&u[s].test(e)){o.style.display="none",l.style.display="";break}o.addEventListener("click",function(e){o.style.display="none",l.style.display=""}),l.addEventListener("click",function(e){l.style.display="none",o.style.display=""}),i.tBodies[0].appendChild(t)},m=s[Symbol.iterator]();!(c=(f=m.next()).done);c=!0)y()}catch(e){d=!0,p=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw p}}if(!s.length){var h=Route._createTd("msg","No pillars found");i.tBodies[0].appendChild(h)}}}},{key:"_addMenuItemRefreshPillar",value:function(e,t){e.addMenuItem("Refresh&nbsp;pillar...",function(e){this._runCommand(e,t,"saltutil.refresh_pillar")}.bind(this))}}])&&oe(n.prototype,r),o&&oe(n,o),t}();function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t,n){return(pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var me=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=fe(t).call(this,"^[/]pillars$","Pillars","#page_pillars","#button_pillars",e))||"object"!==se(o)&&"function"!=typeof o?de(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._updateKeys=n._updateKeys.bind(de(n)),n._updateMinion=n._updateMinion.bind(de(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this;return new Promise(function(t,n){e.resolvePromise=t,e.keysLoaded&&e.jobsLoaded&&t(),e.router.api.getPillarObfuscate(null).then(e._updateMinions),e.router.api.getKeys().then(e._updateKeys),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_updateKeys",value:function(e){var t=this,n=e.return,r=this.getPageElement().querySelector("#minions"),o=n.minions.sort(),i=!0,a=!1,u=void 0;try{for(var l,s=function(){var e=l.value;t._addMinion(r,e,1);var n=document.getElementById(e),o=new DropDownMenu(n);t._addMenuItemShowPillars(o,e),n.addEventListener("click",function(t){return window.location.assign("pillarsminion?minion="+encodeURIComponent(e))})},c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)s()}catch(e){a=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw u}}this.keysLoaded=!0,this.keysLoaded&&this.jobsLoaded&&this.resolvePromise()}},{key:"_updateOfflineMinion",value:function(e,n){pe(fe(t.prototype),"_updateOfflineMinion",this).call(this,e,n);var r=document.getElementById(n);r.appendChild(Route._createTd("pillarinfo","")),r.appendChild(Route._createTd("run-command-button",""))}},{key:"_updateMinion",value:function(e,n,r){pe(fe(t.prototype),"_updateMinion",this).call(this,e,null,r);var o,i=document.getElementById(r),a=Object.keys(n).length;o=0===a?"No pillars":1===a?a+" pillar":a+" pillars";var u=Route._createTd("pillarinfo",o);u.setAttribute("sorttable_customkey",a),i.appendChild(u);var l=new DropDownMenu(i);this._addMenuItemShowPillars(l,r),i.addEventListener("click",function(e){return window.location.assign("pillarsminion?minion="+encodeURIComponent(r))})}},{key:"_addMenuItemShowPillars",value:function(e,t){e.addMenuItem("Show&nbsp;pillars",function(e){window.location.assign("pillarsminion?minion="+encodeURIComponent(t))}.bind(this))}}])&&ce(n.prototype,r),o&&ce(n,o),t}();function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ge(e,t,n){return(ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_e(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Te=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=_e(t).call(this,"^[/]schedules$","Schedules","#page_schedules","#button_schedules",e))||"object"!==he(o)&&"function"!=typeof o?ve(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._updateKeys=n._updateKeys.bind(ve(n)),n._updateMinion=n._updateMinion.bind(ve(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(t,d),n=t,o=[{key:"_fixMinion",value:function(e){var t={schedules:{},enabled:!0};for(var n in e)"enabled"!==n?"schedule"===n&&"{}"===JSON.stringify(e[n])||(t.schedules[n]=e[n]):t.enabled=e.enabled;return t}}],(r=[{key:"onShow",value:function(){var e=this;return new Promise(function(t,n){e.resolvePromise=t,e.keysLoaded&&e.jobsLoaded&&t(),e.router.api.getScheduleList(null).then(e._updateMinions,e._updateMinions),e.router.api.getKeys().then(e._updateKeys),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_updateKeys",value:function(e){var t=this,n=e.return,r=this.getPageElement().querySelector("#minions"),o=n.minions.sort(),i=!0,a=!1,u=void 0;try{for(var l,s=function(){var e=l.value;t._addMinion(r,e,1);var n=document.getElementById(e),o=new DropDownMenu(n);t._addMenuItemShowSchedules(o,e),n.addEventListener("click",function(t){return window.location.assign("schedulesminion?minion="+encodeURIComponent(e))})},c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)s()}catch(e){a=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw u}}this.keysLoaded=!0,this.keysLoaded&&this.jobsLoaded&&this.resolvePromise()}},{key:"_updateOfflineMinion",value:function(e,n){ge(_e(t.prototype),"_updateOfflineMinion",this).call(this,e,n);var r=document.getElementById(n);r.appendChild(Route._createTd("scheduleinfo","")),r.appendChild(Route._createTd("run-command-button",""))}},{key:"_updateMinion",value:function(e,n,r){n=t._fixMinion(n);var o=Object.keys(n.schedules).length,i=o+" schedule"+(1===o?"":"s");n.enabled||(i+=" (disabled)");var a=document.getElementById(r);for(null===a&&((a=document.createElement("tr")).id=r,e.appendChild(a));a.firstChild;)a.removeChild(a.firstChild);a.appendChild(Route._createTd("hostname",r));var u=Route._createTd("status","accepted");u.classList.add("accepted"),a.appendChild(u);var l=Route._createTd("scheduleinfo",i);l.setAttribute("sorttable_customkey",o),a.appendChild(l);var s=new DropDownMenu(a);this._addMenuItemShowSchedules(s,r),a.addEventListener("click",function(e){return window.location.assign("schedulesminion?minion="+encodeURIComponent(r))})}},{key:"_addMenuItemShowSchedules",value:function(e,t){e.addMenuItem("Show&nbsp;schedules",function(e){window.location.assign("schedulesminion?minion="+encodeURIComponent(t))}.bind(this))}}])&&be(n.prototype,r),o&&be(n,o),t}();function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Re(t).call(this,"^[/]schedulesminion$","Schedules","#page_schedulesminion","#button_schedules",e),(n=!o||"object"!==Se(o)&&"function"!=typeof o?Oe(r):o).keysLoaded=!1,n.jobsLoaded=!1,n._showSchedules=n._showSchedules.bind(Oe(n)),document.querySelector("#button_close_schedulesminion").addEventListener("click",function(e){n.router.goTo("/schedules")}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this,t=decodeURIComponent(window.getQueryParam("minion"));return document.getElementById("schedulesminion_title").innerText="Schedules on "+t,new Promise(function(n,r){e.resolvePromise=n,e.keysLoaded&&e.jobsLoaded&&n(),e.router.api.getScheduleList(t).then(e._showSchedules),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs)})}},{key:"_showSchedules",value:function(e){var t=this,n=decodeURIComponent(window.getQueryParam("minion")),r=e.return[0][n];r=SchedulesRoute._fixMinion(r);var o=document.getElementById("schedulesminion_title"),i="Schedules on "+n;r.enabled||(i+=" (disabled)"),o.innerText=i;var a=document.getElementById("schedulesminion_page"),u=new DropDownMenu(a);u.addMenuItem("Enable&nbsp;scheduler...",function(e){this._runCommand(e,n,"schedule.enable")}.bind(this)),u.addMenuItem("Disable&nbsp;scheduler...",function(e){this._runCommand(e,n,"schedule.disable")}.bind(this));var l=document.getElementById("schedulesminion_list");for(a.append(l);l.tBodies[0].rows.length>0;)l.tBodies[0].deleteRow(0);if(r){var s=Object.keys(r.schedules).sort(),c=!0,d=!1,p=void 0;try{for(var f,y=function(){var e=f.value,o=r.schedules[e];"name"in o&&delete o.name,"enabled"in o&&o.enabled&&delete o.enabled,"jid_include"in o&&o.jid_include&&delete o.jid_include,"maxrunning"in o&&1===o.maxrunning&&delete o.maxrunning;var i=document.createElement("tr"),a=Route._createTd("schedule_name",e);i.appendChild(a);var u=o.hasOwnProperty("enabled")&&!o.enabled,s=new DropDownMenu(i),c="schedule.modify "+e;for(var d in o)c=c+" "+d+"="+JSON.stringify(o[d]);s.addMenuItem("Modify&nbsp;job...",function(e){this._runCommand(e,n,c)}.bind(t)),s.addMenuItem("Enable&nbsp;job...",function(t){this._runCommand(t,n,"schedule.enable_job "+e)}.bind(t)),s.addMenuItem("Disable&nbsp;job...",function(t){this._runCommand(t,n,"schedule.disable_job "+e)}.bind(t)),s.addMenuItem("Delete&nbsp;job...",function(t){this._runCommand(t,n,"schedule.delete "+e)}.bind(t)),s.addMenuItem("Run&nbsp;job...",function(t){var r="schedule.run_job";u&&(r+=" force=true"),r+=" "+e,this._runCommand(t,n,r)}.bind(t));var p=Output.formatObject(o),y=Route._createTd("schedule_value",p);u&&y.classList.add("disabled_schedule"),i.appendChild(y),l.tBodies[0].appendChild(i),i.addEventListener("click",function(e){return t._runCommand(e,n,c)})},m=s[Symbol.iterator]();!(c=(f=m.next()).done);c=!0)y()}catch(e){d=!0,p=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw p}}if(!s.length){var h=Route._createDiv("msg","No schedules found");l.tBodies[0].appendChild(h)}}}}])&&ke(n.prototype,r),o&&ke(n,o),t}();function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xe=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Me(t).call(this,"^[/]templates$","Templates","#page_templates","#button_templates",e))||"object"!==Ce(o)&&"function"!=typeof o?Ie(r):o).jobsLoaded=!1,n._updateTemplates=n._updateTemplates.bind(Ie(n)),n._applyTemplate=n._applyTemplate.bind(Ie(n)),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(t,d),n=t,(r=[{key:"onShow",value:function(){var e=this;return new Promise(function(t,n){e.resolvePromise=t,e.jobsLoaded&&t(),e.router.api.getJobs().then(e._updateJobs),e.router.api.getJobsActive().then(e._runningJobs),e.router.api.getConfigValues().then(e._updateTemplates)})}},{key:"_updateTemplates",value:function(e){var t=this.getPageElement().querySelector(".templates"),n=e.return[0].data.return.saltgui_templates;window.localStorage.setItem("templates",JSON.stringify(n));var r=Object.keys(n).sort(),o=!0,i=!1,a=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var s=u.value,c=n[s];this._addTemplate(t,s,c)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}},{key:"_addTemplate",value:function(e,t,n){var r=this,o=document.createElement("tr");o.appendChild(Route._createTd("name",t));var i=n.description;i?o.appendChild(Route._createTd("description",i)):o.appendChild(Route._createTd("description value_none","(none)"));var a=n.targettype,u=n.target;a||u?u?a?o.appendChild(Route._createTd("target",a+" "+u)):o.appendChild(Route._createTd("target",u)):o.appendChild(Route._createTd("target",a)):o.appendChild(Route._createTd("target value_none","(none)"));var l=n.command;l?o.appendChild(Route._createTd("command",l)):o.appendChild(Route._createTd("command value_none","(none)")),new DropDownMenu(o).addMenuItem("Apply&nbsp;template...",function(e){this._applyTemplate(e,a,u,l)}.bind(this)),e.tBodies[0].appendChild(o),o.addEventListener("click",function(e){return r._applyTemplate(e,a,u,l)})}},{key:"_applyTemplate",value:function(e,t,n,r){this._runFullCommand(e,t,n,r)}}])&&Pe(n.prototype,r),o&&Pe(n,o),t}();function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ne(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){var t="function"==typeof Map?new Map:void 0;return(Ae=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Be(e,arguments,We(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Fe(r,e)})(e)}function Be(e,t,n){return(Be=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Fe(o,n.prototype),o}).apply(null,arguments)}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ke=function(e){function t(e,n){var r;return Je(this,t),(r=Ne(this,We(t).call(this))).status=e,r.message=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(t,Ae(Error)),t}(),$e=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Je(this,e),this.APIURL=t}var t,n,r;return t=e,(n=[{key:"isAuthenticated",value:function(){return this.apiRequest("GET","/stats",{}).then(function(e){return null!==window.sessionStorage.getItem("token")},function(e){return!1})}},{key:"login",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pam",r={username:e,password:t,eauth:n};return window.localStorage.setItem("eauth",n),this.apiRequest("POST","/login",r).then(function(e){var t=e.return[0];if(0===Object.keys(t.perms).length)throw new Ke(403,"Unauthorized");window.sessionStorage.setItem("token",t.token)})}},{key:"logout",value:function(){return this.apiRequest("POST","/logout",{}).then(function(e){window.sessionStorage.removeItem("token")})}},{key:"getMinions",value:function(){return this.apiRequest("GET","/minions",{})}},{key:"getKeys",value:function(){return this.apiRequest("GET","/keys",{})}},{key:"getKeysFingerprint",value:function(){return this.apiRequest("POST","/",{client:"wheel",fun:"key.finger",match:"*"}).catch(console.error)}},{key:"getJobs",value:function(){return this.apiRequest("GET","/jobs",{})}},{key:"getJob",value:function(e){return this.apiRequest("GET","/jobs/"+e,{})}},{key:"getGrainsItems",value:function(e){var t={client:"local",fun:"grains.items",tgt_type:"list",tgt:e};return this.apiRequest("POST","/",t).catch(console.error)}},{key:"getPillarItems",value:function(e){var t={client:"local",fun:"pillar.items"};return e?(t.tgt_type="list",t.tgt=e):(t.tgt_type="glob",t.tgt="*"),this.apiRequest("POST","/",t).catch(console.error)}},{key:"getPillarObfuscate",value:function(e){var t={client:"local",fun:"pillar.obfuscate"};return e?(t.tgt_type="list",t.tgt=e):(t.tgt_type="glob",t.tgt="*"),this.apiRequest("POST","/",t).catch(console.error)}},{key:"getScheduleList",value:function(e){var t={client:"local",fun:"schedule.list",kwarg:{return_yaml:!1}};return e?(t.tgt_type="list",t.tgt=e):(t.tgt_type="glob",t.tgt="*"),this.apiRequest("POST","/",t).catch(console.error)}},{key:"getJobsActive",value:function(){return this.apiRequest("POST","/",{client:"runner",fun:"jobs.active"}).catch(console.error)}},{key:"getConfigValues",value:function(){return this.apiRequest("POST","/",{client:"wheel",fun:"config.values"}).catch(console.error)}},{key:"apiRequest",value:function(e,t,n){var r=this.APIURL+t,o=window.sessionStorage.getItem("token"),i={method:e,url:r,headers:{Accept:"application/json","X-Auth-Token":null!==o?o:"","Cache-Control":"no-cache"}};return"POST"===e&&(i.body=JSON.stringify(n)),fetch(r,i).then(function(e){if(e.ok)return e.json();throw new Ke(e.status,e.statusText)})}}])&&qe(t.prototype,n),r&&qe(t,r),e}();function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ge=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callback=this.callback.bind(this),this.verifyAll=this.verifyAll.bind(this),"TR"===t.tagName){var n=i._createTd("","");t.appendChild(n),t=n}switch(this.menuDropdown=i._createDiv("run-command-button",""),t.id){case"cmdbox":this.menuButton=i._createDiv("menu-dropdown","📖"),this.verifyAll();break;default:this.menuButton=i._createDiv("menu-dropdown","≡"),this.verifyAll()}this.menuDropdown.appendChild(this.menuButton),this.menuDropdownContent=i._createDiv("menu-dropdown-content",""),this.menuDropdown.appendChild(this.menuDropdownContent),this.menuDropdown.addEventListener("mouseenter",this.verifyAll),t.appendChild(this.menuDropdown)}var t,n,r;return t=e,(n=[{key:"verifyAll",value:function(){var e=0;if(this.menuDropdownContent){var t=!0,n=!1,r=void 0;try{for(var o,i=this.menuDropdownContent.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,u=a.verifyCallback;u&&u(a),"none"!==a.style.display&&e++}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}var l="TD"===this.menuDropdown.tagName?"table-cell":"inline-block";this.menuDropdown.style.display=e>0?l:"none"}},{key:"addMenuItem",value:function(e,t,n){var r=this,o=i._createDiv("run-command-button","...");"string"==typeof e?o.innerHTML=e:o.verifyCallback=e,o.addEventListener("click",function(e){return r.callback(e,t,n)}),this.menuDropdownContent.appendChild(o),this.verifyAll()}},{key:"callback",value:function(e,t,n){this._value=n,t(e)}},{key:"setTitle",value:function(e){this.menuButton.innerHTML=e+"&nbsp;▼"}},{key:"showMenu",value:function(){this.menuDropdown.style.display="inline-block"}},{key:"hideMenu",value:function(){this.menuDropdown.style.display="none"}}])&&Ue(t.prototype,n),r&&Ue(t,r),e}();function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.commandbox=t,this._manualRunMenuSysDocRun=this._manualRunMenuSysDocRun.bind(this),t.cmdmenu.addMenuItem(this._manualRunMenuSysDocPrepare,this._manualRunMenuSysDocRun)}var t,n,r;return t=e,(n=[{key:"_manualRunMenuSysDocPrepare",value:function(e){var t=document.querySelector(".run-command #target").value;t=t?"target":"all minions";var n=document.querySelector(".run-command #command").value;(n=(n=n.trim().replace(/ .*/,"")).trim().replace(/[.]*$/,"")).match(/^[a-z_][a-z0-9_.]*$/i)&&n?"runners"===n||n.startsWith("runners.")?((n=n.substring(8))&&(n=" "+n),e.innerText="Run 'runners.doc.runner"+n+"'",e.style.display="block"):"wheel"===n||n.startsWith("wheel.")?((n=n.substring(6))&&(n=" "+n),e.innerText="Run 'runners.doc.wheel"+n+"'",e.style.display="block"):(e.innerText="Run 'sys.doc "+n+"' on "+t,e.style.display="block"):e.style.display="none"}},{key:"_manualRunMenuSysDocRun",value:function(){var e=this,t=document.querySelector(".run-command input[type='submit']");if(!t.disabled){var n=document.querySelector(".run-command pre"),r=document.querySelector(".run-command #target").value;""===r&&(r="*");var o,i,a=document.querySelector(".run-command #command").value;a=(a=a.trim().replace(/ .*/,"")).trim().replace(/[.]*$/,""),t.disabled=!0,n.innerText="Loading...","runners"===a||a.startsWith("runners.")?(o="runners.doc.runner",i="runners.doc.runner "+a):"wheel"===a||a.startsWith("wheel.")?(o="runners.doc.wheel",i="runners.doc.wheel "+a):(o="sys.doc "+a,i="sys.doc "+a);var u=TargetType.menuTargetType._value;this.commandbox._getRunParams(u,r,o).then(function(t){return e.commandbox._onRunReturn(t.return[0],i)})}}}])&&He(t.prototype,n),r&&He(t,r),e}();function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createMenu",value:function(){var t=document.getElementById("runblock");e.menuRunType=new Ge(t),e.menuRunType.setTitle(""),e.menuRunType.addMenuItem("Normal",this._updateRunTypeText,"normal"),e.menuRunType.addMenuItem("Async",this._updateRunTypeText,"async")}},{key:"_updateRunTypeText",value:function(){switch(e.getRunType()){case"normal":e.menuRunType.setTitle("Normal");break;case"async":e.menuRunType.setTitle("Async")}}},{key:"setRunTypeDefault",value:function(){e.menuRunType._value="normal",e._updateRunTypeText(),e.menuRunType.setTitle("")}},{key:"getRunType",value:function(){var t=e.menuRunType._value;return void 0===t||""===t?"normal":t}}],(n=null)&&Ve(t.prototype,n),r&&Ve(t,r),e}();function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ye=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createMenu",value:function(){var t=document.getElementById("targetbox");e.menuTargetType=new Ge(t),e.menuTargetType.addMenuItem("Normal",this.manualUpdateTargetTypeText,"glob"),e.menuTargetType.addMenuItem("List",this.manualUpdateTargetTypeText,"list"),e.menuTargetType.addMenuItem(e._targetTypeNodeGroupPrepare,this.manualUpdateTargetTypeText,"nodegroup"),e.menuTargetType.addMenuItem("Compound",this.manualUpdateTargetTypeText,"compound"),e.setTargetTypeDefault()}},{key:"_targetTypeNodeGroupPrepare",value:function(e){var t=window.localStorage.getItem("nodegroups");t&&"{}"!==t?(e.innerText="Nodegroup",e.style.display="block"):e.style.display="none"}},{key:"autoSelectTargetType",value:function(t){if(void 0===e.menuTargetType._value||""===e.menuTargetType._value||e.menuTargetType._system)return t.includes("@")||t.includes(" ")||t.includes("(")||t.includes(")")?(e.menuTargetType._value="compound",void e._updateTargetTypeText()):t.includes(",")?(e.menuTargetType._value="list",void e._updateTargetTypeText()):t.startsWith("#")?(e.menuTargetType._value="nodegroup",void e._updateTargetTypeText()):void e.setTargetTypeDefault()}},{key:"manualUpdateTargetTypeText",value:function(){e.menuTargetType._system=!1,e._updateTargetTypeText()}},{key:"_updateTargetTypeText",value:function(){switch(e.getTargetType()){case"compound":e.menuTargetType.setTitle("Compound");break;case"glob":e.menuTargetType.setTitle("Normal");break;case"list":e.menuTargetType.setTitle("List");break;case"nodegroup":e.menuTargetType.setTitle("Nodegroup")}}},{key:"setTargetTypeDefault",value:function(){e.menuTargetType._value="glob",e.menuTargetType.setTitle(""),e.menuTargetType._system=!0}},{key:"setTargetType",value:function(t){e.menuTargetType._value=t,e.menuTargetType._system=!0,e._updateTargetTypeText()}},{key:"getTargetType",value:function(){var t=e.menuTargetType._value;return void 0===t||""===t?"glob":t}}],(n=null)&&Xe(t.prototype,n),r&&Xe(t,r),e}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t,this._getRunParams=this._getRunParams.bind(this),this._onRun=this._onRun.bind(this),this._onRunReturn=this._onRunReturn.bind(this),this._showManualRun=this._showManualRun.bind(this),this._hideManualRun=this._hideManualRun.bind(this);var n=document.querySelector(".run-command #cmdbox");this.cmdmenu=new Ge(n),this.documentation=new Qe(this),this._registerEventListeners(),ze.createMenu(),Ye.createMenu();var r=document.querySelector(".run-command #templatemenuhere"),o=new Ge(r),i=window.localStorage.getItem("templates");i&&"undefined"!==i||(i="{}");var a=JSON.parse(i),u=Object.keys(a).sort(),l=this,s=!0,c=!1,d=void 0;try{for(var p,f=function(){var e=p.value,t=a[e],n=t.description;n||(n="("+e+")"),o.addMenuItem(n,function(){l._applyTemplate(t)})},y=u[Symbol.iterator]();!(s=(p=y.next()).done);s=!0)f()}catch(e){c=!0,d=e}finally{try{s||null==y.return||y.return()}finally{if(c)throw d}}}var t,n,r;return t=e,(n=[{key:"_registerEventListeners",value:function(){document.querySelector("#popup_runcommand").addEventListener("click",this._hideManualRun),document.querySelector("#button_manualrun").addEventListener("click",this._showManualRun),document.querySelector("#button_close_cmd").addEventListener("click",this._hideManualRun),document.querySelector(".run-command input[type='submit']").addEventListener("click",this._onRun),this._addKeyEventListener("#target",function(e){var t=document.querySelector(".run-command #target").value;Ye.autoSelectTargetType(t)}),this._addKeyEventListener("#command",this.cmdmenu.verifyAll)}},{key:"_applyTemplate",value:function(e){if(e.targettype){var t=e.targettype;document.querySelector("#targetbox").style.display="inherit","glob"!==t&&"list"!==t&&"compound"!==t&&"nodegroup"!==t&&(t="glob"),Ye.setTargetType(t)}else Ye.setTargetTypeDefault();e.target&&(document.querySelector(".run-command #target").value=e.target);e.command&&(document.querySelector(".run-command #command").value=e.command)}},{key:"_addKeyEventListener",value:function(e,t){document.querySelector(e).addEventListener("keyup",t),document.querySelector(e).addEventListener("cut",t),document.querySelector(e).addEventListener("paste",t),document.querySelector(e).addEventListener("blur",t),document.querySelector(e).addEventListener("focus",t)}},{key:"_onRun",value:function(){var e=this,t=document.querySelector(".run-command input[type='submit']");if(!t.disabled){var n=document.querySelector(".run-command pre"),r=document.querySelector(".run-command #target").value,o=document.querySelector(".run-command #command").value,i=Ye.menuTargetType._value,a=this._getRunParams(i,r,o);null!==a&&(t.disabled=!0,n.innerText="Loading...",a.then(function(t){e._onRunReturn(t.return[0],o)}))}}},{key:"_onRunReturn",value:function(e,t){var n=document.querySelector(".run-command pre"),r=Object.keys(e);t.startsWith("runners.")&&(r=["RUNNER"]),t.startsWith("wheel.")&&(r=["WHEEL"]),Output.addResponseOutput(n,r,e,t),document.querySelector(".run-command input[type='submit']").disabled=!1}},{key:"_showManualRun",value:function(e){document.querySelector("#popup_runcommand").style.display="block",document.body.style["overflow-y"]="hidden",document.querySelector(".run-command pre").innerText="Waiting for command...";var t=document.querySelector(".run-command #target").value;Ye.autoSelectTargetType(t),ze.setRunTypeDefault();for(var n=document.getElementById("targetlist");n.firstChild;)n.removeChild(n.firstChild);var r=JSON.parse(window.localStorage.getItem("nodegroups"));if(r){var o=!0,i=!1,a=void 0;try{for(var u,l=Object.keys(r).sort()[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var s=u.value,c=document.createElement("option");c.value="#"+s,n.appendChild(c)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}var d=JSON.parse(window.localStorage.getItem("minions"));if(d){var p=!0,f=!1,y=void 0;try{for(var m,h=d.sort()[Symbol.iterator]();!(p=(m=h.next()).done);p=!0){var b=m.value,v=document.createElement("option");v.value=b,n.appendChild(v)}}catch(e){f=!0,y=e}finally{try{p||null==h.return||h.return()}finally{if(f)throw y}}}e.stopPropagation()}},{key:"_hideManualRun",value:function(e){if("popup"===e.target.className||"nearlyvisiblebutton"===e.target.className){document.querySelector("#popup_runcommand").style.display="none",document.body.style["overflow-y"]="scroll",ze.setRunTypeDefault(),Ye.setTargetTypeDefault();var t=document.querySelector(".run-command #command").value.split(" ")[0],n=document.querySelector(".run-command pre").innerText;["grains.append","grains.delkey","grains.delval","grains.setval","saltutil.refresh_grains","saltutil.refresh_pillar","schedule.delete","schedule.disable","schedule.disable_job","schedule.enable","schedule.enable_job","schedule.modify","wheel.key.accept","wheel.key.delete","wheel.key.reject"].includes(t)&&"Waiting for command..."!==n&&location.reload(),e.stopPropagation()}}},{key:"_showError",value:function(e){this._onRunReturn(e,"")}},{key:"_getRunParams",value:function(e,t,n){var r=this;if("nodegroup"===e&&t.startsWith("#")&&(t=t.substring(1)),""===n)return this._showError("'Command' field cannot be empty"),null;var o=[],i={},a=window.parseCommandLine(n,o,i);if(null!==a)return this._showError(a),null;if(0===o.length)return this._showError("First (unnamed) parameter is the function name, it is mandatory"),null;var u=o.shift();if("string"!=typeof u)return this._showError("First (unnamed) parameter is the function name, it must be a string, not a "+Ze(u)),null;if(""===t&&"runners"!==u&&!u.startsWith("runners."))return this._showError("'Target' field cannot be empty"),null;if("nodegroup"===e){var l=JSON.parse(window.localStorage.getItem("nodegroups"));if(!(l&&t in l))return this._showError("Unknown nodegroup '"+t+"'"),null}var s={};u.startsWith("runners.")?((s=i).client="runner",s.fun=u.substring(8),o.length>0&&(s.arg=o)):u.startsWith("wheel.")?((s=i).client="wheel",s.fun=u.substring(6),s.match=t):(s.client="local",s.fun=u,s.tgt=t,e&&(s.tgt_type=e),0!==o.length&&(s.arg=o),Object.keys(i).length>0&&(s.kwarg=i));var c=ze.getRunType();return"local"===s.client&&"async"===c&&(s.client="local_async"),this.api.apiRequest("POST","/",s).catch(function(e){return r._showError(e.message),e})}}])&&et(t.prototype,n),r&&et(t,r),e}();function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=new $e,this.commandbox=new tt(this.api),this.currentRoute=void 0,this.routes=[];var t=window.localStorage.getItem("templates");t&&"undefined"!==t&&(document.querySelector("#button_templates1").style.display="inline-block",document.querySelector("#button_templates2").style.display="inline-block")}var t,n,r;return t=e,(n=[{key:"bootstrap",value:function(){var e=this;this.registerRoute(new V(this)),this.registerRoute(new ne(this)),this.registerRoute(new K(this)),this.registerRoute(new k(this)),this.registerRoute(new b(this)),this.registerRoute(new Te(this)),this.registerRoute(new je(this)),this.registerRoute(new me(this)),this.registerRoute(new le(this)),this.registerRoute(new P(this)),this.registerRoute(new q(this)),this.registerRoute(new xe(this)),this._registerEventListeners(),this.api.isAuthenticated().then(function(t){return e.goTo(t?window.location.pathname+window.location.search:"/login")}).catch(function(t){console.error(t),e.goTo("/login")})}},{key:"_registerEventListeners",value:function(){var e=this,t=this;document.querySelector(".logo").addEventListener("click",function(e){"/login"!==window.location.pathname&&t.goTo("/")}),document.querySelector("#button_minions1").addEventListener("click",function(e){window.location.replace("/")}),document.querySelector("#button_minions2").addEventListener("click",function(e){window.location.replace("/")}),document.querySelector("#button_grains1").addEventListener("click",function(e){window.location.replace("/grains")}),document.querySelector("#button_grains2").addEventListener("click",function(e){window.location.replace("/grains")}),document.querySelector("#button_schedules1").addEventListener("click",function(e){window.location.replace("/schedules")}),document.querySelector("#button_schedules2").addEventListener("click",function(e){window.location.replace("/schedules")}),document.querySelector("#button_pillars1").addEventListener("click",function(e){window.location.replace("/pillars")}),document.querySelector("#button_pillars2").addEventListener("click",function(e){window.location.replace("/pillars")}),document.querySelector("#button_keys1").addEventListener("click",function(e){window.location.replace("/keys")}),document.querySelector("#button_keys2").addEventListener("click",function(e){window.location.replace("/keys")}),document.querySelector("#button_jobs1").addEventListener("click",function(e){window.location.replace("/jobs")}),document.querySelector("#button_jobs2").addEventListener("click",function(e){window.location.replace("/jobs")}),document.querySelector("#button_templates1").addEventListener("click",function(e){window.location.replace("/templates")}),document.querySelector("#button_templates2").addEventListener("click",function(e){window.location.replace("/templates")}),document.querySelector("#button_logout1").addEventListener("click",function(t){e.api.logout().then(function(){window.location.replace("/")})}),document.querySelector("#button_logout2").addEventListener("click",function(t){e.api.logout().then(function(){window.location.replace("/")})})}},{key:"registerRoute",value:function(e){this.routes.push(e),e.onRegister&&e.onRegister()}},{key:"goTo",value:function(e){if(!(this.switchingRoute||window.location.pathname===e&&this.currentRoute)){var t=!0,n=!1,r=void 0;try{for(var o,i=this.routes[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a.getPath().test(e.split("?")[0]))return window.history.pushState({},void 0,e),void this.showRoute(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}}},{key:"showRoute",value:function(e){var t=this;e.getPageElement().style.display="";var n=document.getElementById("button_minions1"),r=document.getElementById("button_jobs1");Array.from(document.querySelectorAll(".menu_item_active")).forEach(function(e){e.classList.remove("menu_item_active")});var o=e.getMenuItemElement1();o&&(o.classList.add("menu_item_active"),"button_pillars1"!==o.id&&"button_schedules1"!==o.id&&"button_grains1"!==o.id||n.classList.add("menu_item_active"),"button_jobs1"!==o.id&&"button_templates1"!==o.id||r.classList.add("menu_item_active"));var i=e.getMenuItemElement2();i&&i.classList.add("menu_item_active"),t.switchingRoute=!0;var a,u=function(e){void 0!==t.currentRoute&&t.hideRoute(t.currentRoute),t.currentRoute=e,document.title="SaltGUI - "+t.currentRoute.getName(),t.currentRoute.getPageElement().className="route current",t.switchingRoute=!1};e.onShow&&(a=e.onShow()),a&&a.then?a.then(u(e)):u(e)}},{key:"hideRoute",value:function(e){e.getPageElement().className="route",setTimeout(function(){e.getPageElement().style.display="none"},500),e.onHide&&e.onHide()}}])&&nt(t.prototype,n),r&&nt(t,r),e}();window.addEventListener("load",function(){(new rt).bootstrap()})}]);
//# sourceMappingURL=saltgui.bundle.js.map